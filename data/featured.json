{
	"user_info": {
		"name": "HP",
		"id": "8db1fe59-bf9e-4b17-81d6-879b8f8dc7c3",
		"last_activity": "2014 - 06 - 22",
		"query_made": 0
	},
	"features": [
		{
			"name": "Month Sum",
			"description": "Total cost of this month",
			"mode": "normal",
			"fields": [
				"MONTH(date)",
				"SUM(cost)"
			],
			"from": [],
			"criteria": [
				{
					"condition": {
						"field": "MONTH(purchase_set.date)",
						"condition": "=",
						"value": ":var1"
					},
					"values": [
						{
							"id": "1",
							"value": "6",
							"type": "java.lang.Integer"
						}
					]
				},
				{
					"condition": {
						"field": "YEAR(purchase_set.date)",
						"condition": "=",
						"value": ":var2"
					},
					"values": [
						{
							"id": "2",
							"value": "2014",
							"type": "java.lang.Integer"
						}
					]
				}
			],
			"group_by": [],
			"having": [],
			"order_by": []
		},
		{
			"name": "Monthly Sum",
			"description": "Total cost of every month of the year",
			"mode": "normal",
			"fields": [
				"MONTH(date)",
				"SUM(cost)"
			],
			"from": [],
			"criteria": [],
			"group_by": [
				"MONTH(purchase_set.date)"
			],
			"having": [],
			"order_by": []
		},
		{
			"name": "Year Sum",
			"description": "Total cost of this year",
			"mode": "normal",
			"fields": [
				"YEAR(date)",
				"SUM(cost)"
			],
			"from": [],
			"criteria": [
				{
					"condition": {
						"field": "YEAR(purchase_set.date)",
						"condition": "=",
						"value": ":var1"
					},
					"values": [
						{
							"id": "1",
							"value": "2014",
							"type": "java.lang.Integer"
						}
					]
				}
			],
			"group_by": [],
			"having": [],
			"order_by": []
		},
		{
			"name": "Yearly Sum",
			"description": "Total cost of every year",
			"mode": "normal",
			"fields": [
				"YEAR(date)",
				"SUM(cost)"
			],
			"from": [],
			"criteria": [],
			"group_by": [
				"YEAR(purchase_set.date)"
			],
			"having": [],
			"order_by": []
		},
		{
			"name": "Monthly Food Sum",
			"description": "Total cost of food every month of this year",
			"mode": "normal",
			"fields": [
				"MONTH(date)",
				"SUM(cost)"
			],
			"from": [],
			"criteria": [
				{
					"condition": {
						"field": "YEAR(purchase_set.date)",
						"condition": "=",
						"value": ":var1"
					},
					"values": [
						{
							"id": "1",
							"value": "2014",
							"type": "java.lang.Integer"
						}
					]
				},
				{
					"condition": {
						"function": "OR",
						"left": {
							"field": "type",
							"condition": "=",
							"value": ":var11"
						},
						"right": {
							"function": "OR",
							"left": {
								"field": "type",
								"condition": "=",
								"value": ":var10"
							},
							"right": {
								"function": "OR",
								"left": {
									"field": "type",
									"condition": "=",
									"value": ":var9"
								},
								"right": {
									"function": "OR",
									"left": {
										"field": "type",
										"condition": "=",
										"value": ":var8"
									},
									"right": {
										"function": "OR",
										"left": {
											"field": "type",
											"condition": "=",
											"value": ":var7"
										},
										"right": {
											"function": "OR",
											"left": {
												"field": "type",
												"condition": "=",
												"value": ":var6"
											},
											"right": {
												"function": "OR",
												"left": {
													"field": "type",
													"condition": "=",
													"value": ":var5"
												},
												"right": {
													"function": "OR",
													"left": {
														"field": "type",
														"condition": "=",
														"value": ":var4"
													},
													"right": {
														"function": "OR",
														"left": {
															"field": "type",
															"condition": "=",
															"value": ":var3"
														},
														"right": {
															"field": "type",
															"condition": "=",
															"value": ":var2"
														}
													}
												}
											}
										}
									}
								}
							}
						}
					},
					"values": [
						{
							"id": "3",
							"value": "fish",
							"type": "java.lang.String"
						},
						{
							"id": "2",
							"value": "chicken",
							"type": "java.lang.String"
						},
						{
							"id": "10",
							"value": "fruit",
							"type": "java.lang.String"
						},
						{
							"id": "7",
							"value": "rice",
							"type": "java.lang.String"
						},
						{
							"id": "6",
							"value": "bread",
							"type": "java.lang.String"
						},
						{
							"id": "5",
							"value": "pork",
							"type": "java.lang.String"
						},
						{
							"id": "4",
							"value": "beef",
							"type": "java.lang.String"
						},
						{
							"id": "9",
							"value": "vegetable",
							"type": "java.lang.String"
						},
						{
							"id": "8",
							"value": "milk",
							"type": "java.lang.String"
						},
						{
							"id": "11",
							"value": "other food",
							"type": "java.lang.String"
						}
					]
				}
			],
			"group_by": [
				"MONTH(purchase_set.date)"
			],
			"having": [],
			"order_by": []
		},
		{
			"name": "Monthly Non-Food Sum",
			"description": "Total cost of non-food every month of this year",
			"mode": "normal",
			"fields": [
				"MONTH(date)",
				"SUM(cost)"
			],
			"from": [],
			"criteria": [
				{
					"condition": {
						"field": "YEAR(purchase_set.date)",
						"condition": "=",
						"value": ":var1"
					},
					"values": [
						{
							"id": "1",
							"value": "2014",
							"type": "java.lang.Integer"
						}
					]
				},
				{
					"condition": {
						"function": "AND",
						"left": {
							"field": "type",
							"condition": "<>",
							"value": ":var11"
						},
						"right": {
							"function": "AND",
							"left": {
								"field": "type",
								"condition": "<>",
								"value": ":var10"
							},
							"right": {
								"function": "AND",
								"left": {
									"field": "type",
									"condition": "<>",
									"value": ":var9"
								},
								"right": {
									"function": "AND",
									"left": {
										"field": "type",
										"condition": "<>",
										"value": ":var8"
									},
									"right": {
										"function": "AND",
										"left": {
											"field": "type",
											"condition": "<>",
											"value": ":var7"
										},
										"right": {
											"function": "AND",
											"left": {
												"field": "type",
												"condition": "<>",
												"value": ":var6"
											},
											"right": {
												"function": "AND",
												"left": {
													"field": "type",
													"condition": "<>",
													"value": ":var5"
												},
												"right": {
													"function": "AND",
													"left": {
														"field": "type",
														"condition": "<>",
														"value": ":var4"
													},
													"right": {
														"function": "AND",
														"left": {
															"field": "type",
															"condition": "<>",
															"value": ":var3"
														},
														"right": {
															"field": "type",
															"condition": "<>",
															"value": ":var2"
														}
													}
												}
											}
										}
									}
								}
							}
						}
					},
					"values": [
						{
							"id": "3",
							"value": "fish",
							"type": "java.lang.String"
						},
						{
							"id": "2",
							"value": "chicken",
							"type": "java.lang.String"
						},
						{
							"id": "10",
							"value": "fruit",
							"type": "java.lang.String"
						},
						{
							"id": "7",
							"value": "rice",
							"type": "java.lang.String"
						},
						{
							"id": "6",
							"value": "bread",
							"type": "java.lang.String"
						},
						{
							"id": "5",
							"value": "pork",
							"type": "java.lang.String"
						},
						{
							"id": "4",
							"value": "beef",
							"type": "java.lang.String"
						},
						{
							"id": "9",
							"value": "vegetable",
							"type": "java.lang.String"
						},
						{
							"id": "8",
							"value": "milk",
							"type": "java.lang.String"
						},
						{
							"id": "11",
							"value": "other food",
							"type": "java.lang.String"
						}
					]
				}
			],
			"group_by": [
				"MONTH(purchase_set.date)"
			],
			"having": [],
			"order_by": []
		},
		{
			"name": "Incremental average",
			"description": "Sum of month average since beginning of record",
			"mode": "advanced",
			"fields": [
				"MONTH(a.date)",
				"AVG(b.cost)"
			],
			"from": [
				{
					"select": [
						""
					],
					"table": "(\n\t\t\t\t\t\t\t\tSELECT SUM(cost) as cost, ps.date \n\t\t\t\t\t\t\t\tFROM (purchase p LEFT JOIN purchase_set ps ON p.purchase_set = ps.id)\n\t\t\t\t\t\t\t\tGROUP BY MONTH(ps.date)\n\t\t\t\t\t\t\t  ) a\n\t\t\t\t\t\t\t  INNER JOIN\n\t\t\t\t\t\t\t  (\n\t\t\t\t\t\t\t\tSELECT SUM(cost) as cost, ps.date \n\t\t\t\t\t\t\t\tFROM (purchase p LEFT JOIN purchase_set ps ON p.purchase_set = ps.id)\n\t\t\t\t\t\t\t\tGROUP BY MONTH(ps.date)\n\t\t\t\t\t\t\t  ) b\n\t\t\t\t\t\t\t  ON MONTH(a.date) >= MONTH(b.date)",
					"alias": ""
				}
			],
			"criteria": [
				{
					"condition": {
						"field": "YEAR(a.date)",
						"condition": "=",
						"value": "2014"
					},
					"values": []
				}
			],
			"group_by": [
				"MONTH(a.date)"
			],
			"having": [],
			"order_by": []
		}
	]
}